<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>방송통신대 학습 진도 관리</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/lucide.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="container">
                <h1 class="logo" onclick="showPage('dashboard')" style="cursor: pointer;">📚 KNOU Tracker</h1>
                <nav class="nav">
                    <a href="#dashboard" class="nav-link active" data-page="dashboard">대시보드</a>
                    <a href="#student" class="nav-link" data-page="student">개인 현황</a>
                    <a href="#register" class="nav-link" data-page="register">신규 등록</a>
                    <a href="#admin" class="nav-link" data-page="admin">관리</a>
                </nav>
            </div>
        </header>

        <main class="main">
            <!-- Dashboard Page -->
            <div id="dashboard-page" class="page active">
                <div class="container">
                    <div class="dashboard-header">
                        <h2>학습 진도 현황</h2>
                        <div class="stats-summary">
                            <div class="stat-card">
                                <div class="stat-value">5</div>
                                <div class="stat-label">총 학생 수</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">68%</div>
                                <div class="stat-label">평균 진도율</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="student-grid" id="student-grid">
                        <!-- Student cards will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Student Progress Page (개인 현황) -->
            <div id="student-page" class="page">
                <div class="container">
                    <div class="student-header">
                        <div class="student-selector">
                            <label for="student-select">학습자 선택:</label>
                            <select id="student-select" onchange="app.loadStudentProgress(this.value)">
                                <option value="">학습자를 선택하세요</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="student-progress-content" class="student-progress-content" style="display: none;">
                        <div class="student-info-header-inline">
                            <div class="student-inline-info">
                                <h2 id="selected-student-name">학생 이름</h2>
                                <span id="selected-student-department" class="department-badge-inline">학과</span>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar-horizontal">
                                    <div id="progress-bar-fill" class="progress-bar-fill"></div>
                                </div>
                                <span id="overall-progress-percentage" class="progress-percentage-inline">0%</span>
                            </div>
                        </div>

                        <div class="courses-grid" id="courses-grid">
                            <!-- Course cards will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Student Detail Page -->
            <div id="student-detail-page" class="page">
                <div class="container">
                    <div class="student-header">
                        <button class="back-btn" onclick="showPage('dashboard')">← 돌아가기</button>
                        <div class="student-info">
                            <h2 id="student-name">학생 이름</h2>
                            <div class="student-stats">
                                <div class="overall-progress">
                                    <div class="progress-circle">
                                        <svg class="progress-ring" width="120" height="120">
                                            <circle class="progress-ring-circle" cx="60" cy="60" r="50"></circle>
                                        </svg>
                                        <div class="progress-text">
                                            <span class="progress-percentage">0%</span>
                                            <span class="progress-label">전체 진도</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="course-list" id="course-list">
                        <!-- Course progress will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Register Page -->
            <div id="register-page" class="page">
                <div class="container">
                    <div class="register-header">
                        <h2>신규 사용자 등록</h2>
                        <p>학습 진도를 관리하기 위해 필요한 정보를 입력해주세요.</p>
                    </div>

                    <div class="register-form-container">
                        <form id="register-form" class="register-form">
                            <div class="form-group">
                                <label for="register-name">닉네임 *</label>
                                <input type="text" id="register-name" name="name" required placeholder="닉네임을 입력하세요" onblur="app.checkNicknameDuplicate(this.value)">
                                <div id="nickname-validation" class="validation-message"></div>
                            </div>

                            <div class="form-group">
                                <label for="register-department">학과 *</label>
                                <select id="register-department" name="department" required onchange="app.loadCoursesByDepartment()">
                                    <option value="">학과를 선택하세요</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>수강 과목 선택 *</label>
                                <div id="course-selection" class="course-selection">
                                    <p class="course-selection-note">학과를 먼저 선택해주세요.</p>
                                </div>
                            </div>

                            <div class="form-actions">
                                <button type="submit" class="btn-primary">등록하기</button>
                                <button type="button" class="btn-secondary" onclick="app.resetRegisterForm()">초기화</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Admin Page -->
            <div id="admin-page" class="page">
                <div class="container">
                    <h2>관리 패널</h2>
                    
                    <div class="admin-tabs">
                        <button class="tab-btn active" onclick="showAdminTab('users')">학생 관리</button>
                        <button class="tab-btn" onclick="showAdminTab('courses')">과목 관리</button>
                    </div>

                    <!-- Users Tab -->
                    <div id="admin-users" class="admin-tab active">
                        <div class="admin-section">
                            <h3>새 학생 추가</h3>
                            <form id="add-user-form" class="form">
                                <input type="text" id="user-name" placeholder="학생 이름" required>
                                <button type="submit">추가</button>
                            </form>
                        </div>
                        
                        <div class="admin-section">
                            <h3>학생 목록</h3>
                            <div id="user-list" class="user-list">
                                <!-- User list will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Courses Tab -->
                    <div id="admin-courses" class="admin-tab">
                        <div class="admin-section">
                            <h3>학생별 수강 과목 관리</h3>
                            <div class="student-course-management">
                                <div class="student-selection">
                                    <label for="manage-student-select">학생 선택:</label>
                                    <select id="manage-student-select" onchange="app.loadStudentCourses(this.value)">
                                        <option value="">학생을 선택하세요</option>
                                    </select>
                                </div>
                                
                                <div id="student-course-content" class="student-course-content" style="display: none;">
                                    <div class="current-courses-section">
                                        <h4>현재 수강 중인 과목</h4>
                                        <div id="current-courses-list" class="course-management-list">
                                            <!-- Current courses will be populated here -->
                                        </div>
                                    </div>
                                    
                                    <div class="available-courses-section">
                                        <h4>추가 가능한 과목</h4>
                                        <div class="course-filter">
                                            <select id="available-course-department">
                                                <option value="">모든 학과</option>
                                                <option value="통계·데이터">통계·데이터</option>
                                                <option value="컴퓨터">컴퓨터</option>
                                            </select>
                                        </div>
                                        <div id="available-courses-list" class="course-management-list">
                                            <!-- Available courses will be populated here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-links">
                        <a href="https://github.com/ggplab/knou_tracking2" target="_blank" rel="noopener noreferrer" class="github-link">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            <span>GitHub</span>
                        </a>
                    </div>
                    <div class="footer-info">
                        Made by <a href="https://www.linkedin.com/in/jayjunglim/" target="_blank" rel="noopener noreferrer">지지플랏(임정)</a>
                        <span class="version-info">v1.0</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="config.js"></script>
    <script src="logging.js"></script>
    <script src="data.js"></script>
    <script src="app.js"></script>
</body>
</html>